<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Usage • crossLag</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic Usage">
<meta property="og:description" content="crossLag">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crossLag</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bakker.html">Basic Usage</a>
    </li>
    <li>
      <a href="../articles/simulation.html">A Brief Overview of Simulation in the crossLag Package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic Usage</h1>
                        <h4 data-toc-skip class="author">Christopher
Weber</h4>
            
            <h4 data-toc-skip class="date">2024-10-04</h4>
      
      
      <div class="hidden name"><code>bakker.Rmd</code></div>

    </div>

    
    
<p>Yet, it is not uncommon for researchers to use statistical techniques
to identify causal mechanisms, occasionally with very little theorizing
about the data generating process. One such statistical technique is the
cross-lagged panel model (CLPM). The CLPM is a variant of the
Autoregressive Distributed Lag model used in econometrics, and the
identified causal mechanism is a particular type of causality, Granger
Causality. The reasoning is both simple and elegant. The notion is that
if one measures <span class="math inline">\(x\)</span> at time <span class="math inline">\(t-1\)</span> and <span class="math inline">\(t\)</span>, and <span class="math inline">\(y\)</span> at time <span class="math inline">\(t-1\)</span> and <span class="math inline">\(t\)</span>, then one estimates a model that
predicts <span class="math inline">\(y_{t}\)</span> from <span class="math inline">\(x_{t-1}\)</span> and <span class="math inline">\(y_{t-1}\)</span>, and an additional model where
<span class="math inline">\(x_{t}\)</span> is predicted from <span class="math inline">\(y_{t-1}\)</span> and <span class="math inline">\(x_{t-1}\)</span>. The temporal ordering of the
data is then used to identify causal relationships. Although one may not
be able to manipulate <span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span> – to rule out spurious relationships –
if <span class="math inline">\(x\)</span> measured in the past predicts
<span class="math inline">\(y\)</span> in the present, but <span class="math inline">\(y\)</span> measured in the past doesn’t predict
<span class="math inline">\(x\)</span> in the present, one can be
reasonably certain that the causal ordering is such that <span class="math inline">\(x\)</span> affects <span class="math inline">\(y\)</span> and <span class="math inline">\(y\)</span> does not affect <span class="math inline">\(x\)</span>. Graphically, the model can be
represented as a Directed Acyclic Graph (DAG, Pearl 2001).</p>
<p>The CLPM is a variant of the Autoregressive Distributed Lag model
used in econometrics, and the causal mechanism identified is often
referred to as Granger Causality. Granger causality is a concept that
means that if <span class="math inline">\(x\)</span> measured at time
<span class="math inline">\(t-1\)</span> predicts <span class="math inline">\(y\)</span> at time <span class="math inline">\(t\)</span>, then <span class="math inline">\(x\)</span> Granger causes <span class="math inline">\(y\)</span>. The CLPM can be written as</p>
<p>The conclusions from the CLPM attempts to leverage the temporal order
in which variables are observed. If one were to estimate these two
equations using traditional regression techniques, a large <span class="math inline">\(a_2\)</span> coefficient represents a causal
relationship from <span class="math inline">\(x_1\rightarrow
y_2\)</span>; whereas a large <span class="math inline">\(b_2\)</span>
coefficient translates to reversed effect, i.e., <span class="math inline">\(y_1 \rightarrow x_2\)</span>. If <span class="math inline">\(a_2\)</span> is large and <span class="math inline">\(b_2\)</span> is effectively zero, it is tempting
to conclude that <span class="math inline">\(x\)</span> causes <span class="math inline">\(y\)</span> but <span class="math inline">\(y\)</span> does not cause <span class="math inline">\(x\)</span>. In both cases, we include the lagged
value of the dependent variable, <span class="math inline">\(y_{t-1,
i}\)</span> and <span class="math inline">\(x_{t-1, i}\)</span>, to
control for the effect of the dependent variable; each unit serves as
their own control, or baseline. Should <span class="math inline">\(a_2\)</span> or <span class="math inline">\(b_2\)</span> reach conventional levels of
statistical significance, it is tempting to conclude that a causal
effect has been identified. Economists refer to this as Granger
Causality, which is a statistical test of whether the lagged value of
the independent variable can predict the dependent variable after
controlling for the lagged value of the dependent variable.</p>
<p>While the reasoning is simple, rather strong assumptions about the
data generating process must be made.. There several issues that arise
upon estimating this model. The first pertains to the empirical
consequence of including a lagged realization of the independent
variable in the regression model, rather than contemporaneous effects;
the the second issue pertains to inclusion of a lagged dependent
variable (Allison 1990); and the third revolves around the
identification of causal effects, particularly when there are unobserved
confounders and stable unit effects.</p>
<div class="section level2">
<h2 id="contemporaneous-and-lagged-effects">Contemporaneous and Lagged Effects<a class="anchor" aria-label="anchor" href="#contemporaneous-and-lagged-effects"></a>
</h2>
<p>A notoriously difficult issue with observational cross-section data
is the identification of causal effects. The conditional effect of <span class="math inline">\(x\)</span> on <span class="math inline">\(y\)</span> <span class="math inline">\(x
\rightarrow y\)</span> even in the most carefully specified model, using
sophisticated regression techniques will rarely allow one to rule out
the possibility that an effect is spurious. This is because the
researcher cannot control for all possible confounders.</p>
<p>It is tempting to draw upon panel data in these circumstances. The
researcher may then include a lag of the indepedendent variable,
empirically sidestepping the thorny issue of trying to identify the
contemporaneous effect of <span class="math inline">\(x\)</span> on
<span class="math inline">\(y\)</span>. While the
<strong>contemporaneous causal</strong> effect cannot be reliably
estimated because it is likely confounded by unobservable variables. It
is tempting to leverage the temporal nature of the data to estimate a
lagged causal effect in place of the contemporaneous causal effect.</p>
<p>Such reasoning is relatively commom in the social sciences, dating
back to the pioneering work of Campbell (1963) as well as Campbell and
Stanley (1963). The publication of Finkel’s (1995) Sage monograph
further popularized the technique. It is commonly used and referenced in
empirical work, including that of the authors of this paper, on more
than one occasion. For instance, Weber and Federico examine how
authoritarianism stems from anxious and avoidant psychological
attachment patterns. In defense of their findings, they write:</p>
<blockquote>
<p>Although we assume that general psychological orientations like
anxiety and avoidance should be causally prior to worldviews and
ideology—like other researchers in this area (e.g., Jost et al.,
2003)—longitudinal data would provide a less-ambiguous pattern of
support for this assumption. For example, panel data on all relevant
constructs would allow us to examine the strength of competing causal
patterns using a cross-lagged design (Finkel, 1995). Similarly, actual
developmental data might allow us to see whether attachment patterns
early in life are predictive of different worldviews and ideologies
later on.</p>
</blockquote>
<p>Yet, Bellamare et al (2017) notes that a lagged realization of the
independent variable does not necessarily improve one’s ability to
identify a causal effect. Instead, it sidesteps the problem, moving from
the identification of a contemporaneous causal effect to identifying a
lagged causal effect. Unfortunately, the ordering of observations does
not immediately improve one’s ability to identify a causal relationship,
except in restrictive circumstances.</p>
<p>In particular, focusing on the lag of x moves the problem to
identifying a lagged causal effect, effectively ignoring causal
mechanisms that operate contemporaneously. This can be theoretically or
empirically problematic. Theoretically, it is difficult to defend the
notion that only a lagged, rather than contemporary, realization of the
independent variable causally flows to the dependent variable.
Empirically, failing to include contemporaneous independent variables in
equations 1 and 2 will distort the estimated effect of the lagged
independent variable on the dependent variable. The regression model may
be be misspeficied, and the estimated coefficients subsequently
biased.</p>
<p>Likewise, the inclusion of a lagged dependent variable is also
problematic, for reasons well-documented in the literature (see Allison
1990). Introductory statistics textbooks present it in the context of
autocorrelation, whereby including a lagged realization of the dependent
variable will correlate with the error terms in equations (1) and (2),
subsequently biasing parameter estimates and standard errors.</p>
<div class="section level3">
<h3 id="the-dag">The DAG<a class="anchor" aria-label="anchor" href="#the-dag"></a>
</h3>
<p>Identitying causal effects with observational data is difficult due
to the presence of confounding variables. The problem is not limited to
cross-sectional data, and also apply to observational panel data (though
occasionally for different reasons). Consider the causal diagram in
Figure 2, a slight modification on the CLR model presented in Figure 1.
In this case, we have added a confounder set <span class="math inline">\(U\)</span> that is correlated with both <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y_1\)</span>, as well as <span class="math inline">\(x_2\)</span> and <span class="math inline">\(y_2\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.dagitty.net" class="external-link">dagitty</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-causal/ggdag" class="external-link">ggdag</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'ggdag'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/dagitty.html" class="external-link">dagitty</a></span><span class="op">(</span><span class="st">"dag {</span></span>
<span><span class="st">    X1 -&gt; Y2 </span></span>
<span><span class="st">    Y1 -&gt; Y2</span></span>
<span><span class="st">    X1 -&gt; X2 </span></span>
<span><span class="st">    Y1 -&gt; X2</span></span>
<span><span class="st">    U -&gt; X1</span></span>
<span><span class="st">    U -&gt; Y1</span></span>
<span><span class="st">    U -&gt; X2</span></span>
<span><span class="st">    U -&gt; Y2</span></span>
<span><span class="st">    U &lt;-&gt; U</span></span>
<span><span class="st">}"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> Y1<span class="op">=</span><span class="fl">1</span>,X1<span class="op">=</span><span class="fl">1</span>,Y2<span class="op">=</span><span class="fl">2</span>,X2<span class="op">=</span><span class="fl">2</span>, U<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>    y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> Y1<span class="op">=</span><span class="fl">1</span>,X1<span class="op">=</span><span class="fl">2</span>,Y2<span class="op">=</span><span class="fl">1</span>,X2<span class="op">=</span><span class="fl">2</span>, U<span class="op">=</span><span class="fl">2.4</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://r-causal.github.io/ggdag/reference/ggdag.html" class="external-link">ggdag</a></span><span class="op">(</span><span class="va">g</span>, text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html" class="external-link">theme_dag</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Figure 2: The Cross-Lagged Regression (CLR) Model.\nConfounding by U"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bakker_files/figure-html/unnamed-chunk-1-1.png" width="40%"></p>
<p>In this case, the confounder set creates a “backdoor path” from U to
<span class="math inline">\(x_2\)</span> and <span class="math inline">\(y_2\)</span> through <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y_1\)</span>. Ignoring the confounder set <span class="math inline">\(U\)</span> will bias the estimates of the
coefficients estimated in the model; this is the notion of “spurious
regression” whereby we may even estimate a relationship when none
exist.The solution advocated in most textbooks is to include the
confounder set <span class="math inline">\(U\)</span> in one’s
regression model. This is also known as “back-door adjustment” as we
condition on this confounder set blocking any paths that run through
<span class="math inline">\(U\)</span>. This is reason researchers often
include a set of control variables, occasionally an unwieldy set, a
“kitchen sink” of numerous variables that may or may not be controls
(King, 20??).</p>
<p>The figure below demonstrates that including the confounder set <span class="math inline">\(U\)</span> blocks the backdoor path from <span class="math inline">\(x_2\)</span> to <span class="math inline">\(y_2\)</span> through <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y_1\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-causal.github.io/ggdag/reference/adjustment_sets.html" class="external-link">ggdag_adjustment_set</a></span><span class="op">(</span><span class="va">g</span>, exposure <span class="op">=</span> <span class="st">"Y1"</span>, outcome <span class="op">=</span> <span class="st">"Y2"</span>, shadow <span class="op">=</span> <span class="st">"TRUE"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html" class="external-link">theme_dag</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Figure 3: We need to condition on:"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bakker_files/figure-html/unnamed-chunk-2-1.png" width="40%"></p>
<p>What if – in addition to the counfounder set – there exists
contemporaneous effects, such as, <span class="math inline">\(x_1\)</span> <span class="math inline">\(y_2\)</span> and <span class="math inline">\(x_2\)</span> <span class="math inline">\(y_2\)</span>? Now the causal diagram becomes:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/dagitty.html" class="external-link">dagitty</a></span><span class="op">(</span><span class="st">"dag {</span></span>
<span><span class="st">    X1 -&gt; Y2 </span></span>
<span><span class="st">    X2 -&gt; Y2 </span></span>
<span><span class="st">    Y1 -&gt; Y2</span></span>
<span><span class="st">    X1 -&gt; X2 </span></span>
<span><span class="st">    Y1 -&gt; X2</span></span>
<span><span class="st">    U -&gt; Y1</span></span>
<span><span class="st">    U -&gt; Y2</span></span>
<span><span class="st">    X1 -&gt; Y1</span></span>
<span><span class="st">}"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> Y1<span class="op">=</span><span class="fl">1</span>,X1<span class="op">=</span><span class="fl">1</span>,Y2<span class="op">=</span><span class="fl">2</span>,X2<span class="op">=</span><span class="fl">2</span>, U<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>    y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> Y1<span class="op">=</span><span class="fl">1</span>,X1<span class="op">=</span><span class="fl">2</span>,Y2<span class="op">=</span><span class="fl">1</span>,X2<span class="op">=</span><span class="fl">2</span>, U<span class="op">=</span><span class="fl">2.4</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://r-causal.github.io/ggdag/reference/ggdag.html" class="external-link">ggdag</a></span><span class="op">(</span><span class="va">g</span>, text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html" class="external-link">theme_dag</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Figure 4: The Cross-Lagged Regression (CLR) Model.\nContemporaneous Causal Effect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bakker_files/figure-html/unnamed-chunk-3-1.png" width="40%"></p>
<p>The presence of these contemporaneous effects poses a problem for two
reasons. First, <span class="math inline">\(x_1 \rightarrow x_2
\rightarrow y_2\)</span>, where <span class="math inline">\(x_2\)</span>
mediates the effect of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y_2\)</span>. What is more, <span class="math inline">\(y_1\)</span> also serves a mediator for this
effect. These effects are omitted from the CLPM as specified above.
However, if such a relationship exists, including <span class="math inline">\(y_1\)</span> – the lag of y, which we have done
above – is also problematic. The reason is that <span class="math inline">\(y_1\)</span> is a “collider.” Conditioning on
<span class="math inline">\(y_1\)</span> – the lag – will open several
backdoor paths that will bias the estimated coefficients. In. this case,
<span class="math inline">\(y_1\)</span> opens up backdoor paths whereby
the effect of <span class="math inline">\(y_1\)</span> represents a
potentially true effect plus indirect paths where the independent
variable and the unobserved confounder affects <span class="math inline">\(y_2\)</span>. Because of this “collider bias”
(Pearl 2001), one might be better served by excluding <span class="math inline">\(y_1\)</span> from the estimated equation, adopting
a simpler model, <span class="math inline">\(y_2 = \beta_1 x_1 +
\epsilon\)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="simulate-data">Simulate Data<a class="anchor" aria-label="anchor" href="#simulate-data"></a>
</h2>
<span class="math display">\[\begin{eqnarray}
E(Y^{X1=1} - Y^{X1=0} ) = E_{Z, U} [E(Y|X1=0, Z, U) - [E(Y|X1=0, Z, U)]
= c_2\\
&amp; E_{Z} [E(Y|X1=0, Z) - [E(Y|X1=0, Z)] = c_2 + \\
\end{eqnarray}\]</span>
<p>to examine some of this, let’s simulated some data, using the package
“CrossLag” – which includes a simulation function
“simulate_observed_clr.”</p>
<ul>
<li>
<em>simulate_observed_clr</em>: Simulate data for a cross-lagged
panel model</li>
<li>Vary cross lag, stability, waves, and contemporaneous effects</li>
</ul>
<p>The function returns a list, the first element is the lavaan model
syntax used to generate the data. The second is the data itself. This
allows us to make necessary modifications to the model, which can be
applied to the data.</p>
<p>Let’s start by simulating a 2 wave panel with 100 observations. Vary
the following :</p>
<ul>
<li>The effect of the unobserved confounder on the observed variables.
[-0.8, 0.8]</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christopher Weber:.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
