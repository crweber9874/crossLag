<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="crossLag">
<title>A Brief Overview of Simulation in the crossLag Package • crossLag</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Brief Overview of Simulation in the crossLag Package">
<meta property="og:description" content="crossLag">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">crossLag</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/simulation.html">A Brief Overview of Simulation in the crossLag Package</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A Brief Overview of Simulation in the crossLag Package</h1>
                        <h4 data-toc-skip class="author">Christopher
Weber</h4>
            
            <h4 data-toc-skip class="date">2024-10-05</h4>
      
      
      <div class="d-none name"><code>simulation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-cross-lagged-panel-model-clpm">The Cross Lagged Panel Model (CLPM)<a class="anchor" aria-label="anchor" href="#the-cross-lagged-panel-model-clpm"></a>
</h2>
<p>It is difficult to sort out causal mechanisms with cross-sectional
observational data, panel and cross sectional. Causal relationships
require careful theorizing about the data generating process. Data,
particularly when observational, and statistical procedures do not
guarantee that researcher will identify a causal mechanism.</p>
<p>The CLPM is common in many social science applications, particularly
in longitudinal, observational research designs.</p>
<p>The design is straightforward, motivated by the difficulty in
figuring out whether <span class="math inline">\(X \rightarrow
Y\)</span>, <span class="math inline">\(Y \rightarrow X\)</span>. It’s
also a common design in practice (Federico and Gole De Zavala 2023;
Craemer 2008; Claasen 2008; Hatemi, Crabtree and Smith 2019;
Hetherington and Globeti 2002; Luttig 2021, Klandermans 2004; Lupu 2015;
Goren and Chapp 2017; Layman and Carsey 2002; Putz 2002; Tilley, Neundor
and Hobolt 2018; Sibley and Duckitt 2010, among many others)</p>
</div>
<div class="section level2">
<h2 id="political-psychology-examples">Political Psychology Examples<a class="anchor" aria-label="anchor" href="#political-psychology-examples"></a>
</h2>
<div style="font-size: 0.7em;">
<table class="table">
<colgroup>
<col width="45%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th>Reference</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Bakker, Lelkes and Malka (2021)</td>
<td>Politics and personality reciprocal effects</td>
</tr>
<tr class="even">
<td>Brandt, Wetherell, and Henry (2015)</td>
<td>Income/SES predicts trust</td>
</tr>
<tr class="odd">
<td>Claibourn and Martin (2000)</td>
<td>Joining groups increases interpersonal trust</td>
</tr>
<tr class="even">
<td>Campbell, Layman, Green and Sumaktoyo (2018)</td>
<td>Religion is endogenous to party</td>
</tr>
<tr class="odd">
<td>Carsey and Layman (2006)</td>
<td>Party attachment and ideology</td>
</tr>
<tr class="even">
<td>Claasen (2008)</td>
<td>Party identification and campaign participation</td>
</tr>
<tr class="odd">
<td>Federico and Gole De Zavala (2023)</td>
<td>Collective narcissism and nationalism</td>
</tr>
<tr class="even">
<td>Goren and Chapp (2017)</td>
<td>Culture war attitudes predict religion and partisan affiliation</td>
</tr>
<tr class="odd">
<td>Hetherington and Globetti (2002)</td>
<td>Trust predicts preferences for spending (among Whites)</td>
</tr>
<tr class="even">
<td>Luttig (2021)</td>
<td>Authoritarianism is endogenous to party</td>
</tr>
<tr class="odd">
<td>Sibley and Duckitt (2010)</td>
<td>SDO, RWA</td>
</tr>
</tbody>
</table>
</div>
<p>Yet, it is not uncommon for researchers to use statistical techniques
to identify causal mechanisms, occasionally with very little theorizing
about the data generating process. One such statistical technique is the
cross-lagged panel model (CLPM). The CLPM is a variant of the
Autoregressive Distributed Lag model used in econometrics, and the
identified causal mechanism is a particular type of causality, Granger
Causality. The reasoning is both simple and elegant. The notion is that
if one measures <span class="math inline">\(x\)</span> at time <span class="math inline">\(t-1\)</span> and <span class="math inline">\(t\)</span>, and <span class="math inline">\(y\)</span> at time <span class="math inline">\(t-1\)</span> and <span class="math inline">\(t\)</span>, then one estimates a model that
predicts <span class="math inline">\(y_{t}\)</span> from <span class="math inline">\(x_{t-1}\)</span> and <span class="math inline">\(y_{t-1}\)</span>, and an additional model where
<span class="math inline">\(x_{t}\)</span> is predicted from <span class="math inline">\(y_{t-1}\)</span> and <span class="math inline">\(x_{t-1}\)</span>. The temporal ordering of the
data is then used to identify causal relationships. Although one may not
be able to manipulate <span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span> – to rule out spurious relationships –
if <span class="math inline">\(x\)</span> measured in the past predicts
<span class="math inline">\(y\)</span> in the present, but <span class="math inline">\(y\)</span> measured in the past doesn’t predict
<span class="math inline">\(x\)</span> in the present, one can be
reasonably certain that the causal ordering is such that <span class="math inline">\(x\)</span> affects <span class="math inline">\(y\)</span> and <span class="math inline">\(y\)</span> does not affect <span class="math inline">\(x\)</span>. Graphically, the model can be
represented as a Directed Acyclic Graph (DAG, Pearl 2001).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.dagitty.net" class="external-link">dagitty</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-causal/ggdag" class="external-link">ggdag</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repr.plot.width <span class="op">=</span> <span class="fl">2</span>, repr.plot.height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Set smaller plot size</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/dagitty.html" class="external-link">dagitty</a></span><span class="op">(</span><span class="st">"dag {</span></span>
<span><span class="st">    X1 -&gt; Y2 </span></span>
<span><span class="st">    Y1 -&gt; Y2</span></span>
<span><span class="st">    X1 -&gt; X2 </span></span>
<span><span class="st">    Y1 -&gt; X2</span></span>
<span><span class="st"></span></span>
<span><span class="st">}"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>U1<span class="op">=</span><span class="fl">0.5</span>, Y1<span class="op">=</span><span class="fl">1</span>,X1<span class="op">=</span><span class="fl">1</span>,Y2<span class="op">=</span><span class="fl">2</span>,X2<span class="op">=</span><span class="fl">2</span>, U2<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>U1<span class="op">=</span><span class="fl">1.5</span>, Y1<span class="op">=</span><span class="fl">1</span>,X1<span class="op">=</span><span class="fl">2</span>,Y2<span class="op">=</span><span class="fl">1</span>,X2<span class="op">=</span><span class="fl">2</span>, U2<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://r-causal.github.io/ggdag/reference/ggdag.html" class="external-link">ggdag</a></span><span class="op">(</span><span class="va">g</span>, text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html" class="external-link">theme_dag</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Figure 1: The Cross-Lagged Regression (CLR) Model"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="simulation_files/figure-html/unnamed-chunk-1-1.png" width="40%"></p>
<p>The CLPM is a variant of the Autoregressive Distributed Lag model
used in econometrics, and the causal mechanism identified is often
referred to as Granger Causality. Granger causality is a concept that
means that if <span class="math inline">\(x\)</span> measured at time
<span class="math inline">\(t-1\)</span> predicts <span class="math inline">\(y\)</span> at time <span class="math inline">\(t\)</span>, then <span class="math inline">\(x\)</span> Granger causes <span class="math inline">\(y\)</span>. The CLPM can be written as</p>
<p>$$y_{t, i}=a_0 + a_1 y_{t-1, i} + a_2 x_{t-1, i} + e_{1,i}</p>
<pre><code>x_{t, i}=b_0 + b_1 y_{t-1, i} + b_2 x_{t-1, i} + e_{2,i}</code></pre>
<p>$$</p>
<p>The conclusions from the CLPM attempts to leverage the temporal order
in which variables are observed. If one were to estimate these two
equations using traditional regression techniques, a large <span class="math inline">\(a_2\)</span> coefficient represents a causal
relationship from <span class="math inline">\(x_1\rightarrow
y_2\)</span>; whereas a large <span class="math inline">\(b_2\)</span>
coefficient translates to reversed effect, i.e., <span class="math inline">\(y_1 \rightarrow x_2\)</span>. If <span class="math inline">\(a_2\)</span> is large and <span class="math inline">\(b_2\)</span> is effectively zero, it is tempting
to conclude that <span class="math inline">\(x\)</span> causes <span class="math inline">\(y\)</span> but <span class="math inline">\(y\)</span> does not cause <span class="math inline">\(x\)</span>. In both cases, we include the lagged
value of the dependent variable, <span class="math inline">\(y_{t-1,
i}\)</span> and <span class="math inline">\(x_{t-1, i}\)</span>, to
control for the effect of the dependent variable; each unit serves as
their own control, or baseline. Should <span class="math inline">\(a_2\)</span> or <span class="math inline">\(b_2\)</span> reach conventional levels of
statistical significance, it is tempting to conclude that a causal
effect has been identified. Economists refer to this as Granger
Causality, which is a statistical test of whether the lagged value of
the independent variable can predict the dependent variable after
controlling for the lagged value of the dependent variable.</p>
<p>While the reasoning is simple, rather strong assumptions about the
data generating process must be made.. There several issues that arise
upon estimating this model. The first pertains to the empirical
consequence of including a lagged realization of the independent
variable in the regression model, rather than contemporaneous effects;
the the second issue pertains to inclusion of a lagged dependent
variable (Allison 1990); and the third revolves around the
identification of causal effects, particularly when there are unobserved
confounders and stable unit effects.</p>
</div>
<div class="section level2">
<h2 id="political-psychology-personality-and-politics">Political Psychology, Personality and Politics<a class="anchor" aria-label="anchor" href="#political-psychology-personality-and-politics"></a>
</h2>
<p>As an example, let’se focus here primarily on its applicability in
political psychology, exploring the relationship between
<strong>Personality and Politics</strong> (Luttig 2021; Bakker, Lelkes,
and Malke 2021). It’s common to use the CLPM in these settings, or
propose doing so. Weber and Federico (2007) note,</p>
<blockquote>
<p>Although we assume that general psychological orientations like
anxiety and avoidance should be causally prior to worldviews and
ideology—like other researchers in this area (e.g., Jost et al.,
2003)—longitudinal data would provide a less-ambiguous pattern of
support for this assumption. For example, panel data on all relevant
constructs would allow us to examine the strength of competing causal
patterns using a cross-lagged design (Finkel, 1995). Similarly, actual
developmental data might allow us to see whether attachment patterns
early in life are predictive of different worldviews and ideologies
later on.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="complicated-effects">Complicated Effects<a class="anchor" aria-label="anchor" href="#complicated-effects"></a>
</h2>
<p>$$y_{t, i}=a_0 + a_1 y_{t-1, i} + a_2 x_{t-1, i} + e_{1,i}</p>
<pre><code>x_{t, i}=b_0 + b_1 y_{t-1, i} + b_2 x_{t-1, i} + e_{2,i}</code></pre>
<p>$$</p>
<p><img src="../docs/articles/simulation_files/figure-html/unnamed-chunk-2-1.gif"><!-- --></p>
</div>
<div class="section level2">
<h2 id="simulating-data-using">Simulating Data using $<a class="anchor" aria-label="anchor" href="#simulating-data-using"></a>
</h2>
<p>Simulate five trials, of a three wave panel, with no cross lag
effects, weak with person stability, and no confounding.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://crweber9874.github.io/crossLag/">crossLag</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/monteCarlo.html">monteCarlo</a></span><span class="op">(</span></span>
<span>    trials <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    waves <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"ols"</span>,</span>
<span>    data_generation <span class="op">=</span> <span class="st">"ri-clpm"</span>,</span>
<span>    within_person_stability_x <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    within_person_stability_y <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    cross_lag_x <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    cross_lag_y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    confound <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    variance_x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    variance_y <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    sample_size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   confound within_person_stability_x within_person_stability_y         xlag</span></span>
<span><span class="co">## 1        0                       0.1                       0.1  0.019895582</span></span>
<span><span class="co">## 2        0                       0.1                       0.1  0.001196225</span></span>
<span><span class="co">## 3        0                       0.1                       0.1 -0.012555982</span></span>
<span><span class="co">## 4        0                       0.1                       0.1  0.002984921</span></span>
<span><span class="co">## 5        0                       0.1                       0.1  0.010791678</span></span>
<span><span class="co">##         ylag trial model data_generation</span></span>
<span><span class="co">## 1 0.03054901     1   ols         ri-clpm</span></span>
<span><span class="co">## 2 0.07300999     2   ols         ri-clpm</span></span>
<span><span class="co">## 3 0.04822117     3   ols         ri-clpm</span></span>
<span><span class="co">## 4 0.04696841     4   ols         ri-clpm</span></span>
<span><span class="co">## 5 0.07474887     5   ols         ri-clpm</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="fit-a-cross-lagged-panel-model">Fit a Cross-Lagged Panel Model<a class="anchor" aria-label="anchor" href="#fit-a-cross-lagged-panel-model"></a>
</h2>
<p>Simulate data</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simulate_riclpm.html">simulate_riclpm</a></span><span class="op">(</span></span>
<span>         waves <span class="op">=</span> <span class="fl">4</span>,</span>
<span>         stability.p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         stability.q <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         cross.p <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>         cross.q <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>         variance.p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         variance.q <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         cov.pq <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            x1         y1         x2         y2         x3         y3        x4</span></span>
<span><span class="co">## 1  0.99982812  0.4068819  1.7418094  2.3464627  1.7013029  1.7732967  2.046755</span></span>
<span><span class="co">## 2 -0.26749595  2.1388097  2.5434295  2.1142662  1.2703638  3.8885879  3.168168</span></span>
<span><span class="co">## 3  1.52309243 -0.8949587  1.8611301  1.1628661  1.3794057 -1.2160852  2.652900</span></span>
<span><span class="co">## 4 -0.91576415 -0.4653294 -1.3666753  0.8804835  0.7041079  1.6206294  2.934414</span></span>
<span><span class="co">## 5  0.01053924 -0.3734601  0.2167635 -0.0795669 -3.7255518  0.1711857 -4.978202</span></span>
<span><span class="co">## 6 -2.60533934 -1.7286504 -3.5175774 -2.6375363 -2.0835889 -2.7476928 -2.176048</span></span>
<span><span class="co">##           y4           U       kappa       omega</span></span>
<span><span class="co">## 1  2.6366688  1.50462718  0.40645143  0.40645139</span></span>
<span><span class="co">## 2  3.5553827 -0.64779087 -0.20970804 -0.20970804</span></span>
<span><span class="co">## 3  0.1520823 -1.68064243 -0.86519976 -0.86519981</span></span>
<span><span class="co">## 4  4.8759890  0.01331896 -0.14020274 -0.14020274</span></span>
<span><span class="co">## 5 -1.6892058  0.03811347  0.01040741  0.01040743</span></span>
<span><span class="co">## 6 -1.4500491  0.45538096 -0.68029130 -0.68029129</span></span></code></pre>
<p>Each call returns a list, with one element <span class="math inline">\(\texttt{data}\)</span> and one <span class="math inline">\(\texttt{model}\)</span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simulate_riclpm.html">simulate_riclpm</a></span><span class="op">(</span></span>
<span>         waves <span class="op">=</span> <span class="fl">4</span>,</span>
<span>         stability.p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         stability.q <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         cross.p <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>         cross.q <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>         variance.p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         variance.q <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         cov.pq <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## x1 ~ mu1*0</span></span>
<span><span class="co">## y1 ~ pi1*0</span></span>
<span><span class="co">## x2 ~ mu2*0</span></span>
<span><span class="co">## y2 ~ pi2*0</span></span>
<span><span class="co">## x3 ~ mu3*0</span></span>
<span><span class="co">## y3 ~ pi3*0</span></span>
<span><span class="co">## x4 ~ mu4*0</span></span>
<span><span class="co">## y4 ~ pi4*0</span></span>
<span><span class="co">## kappa ~~0.25* kappa</span></span>
<span><span class="co">##                                          </span></span>
<span><span class="co">## omega ~~0.25* omega</span></span>
<span><span class="co">##                                          </span></span>
<span><span class="co">## kappa ~~0.25* omega</span></span>
<span><span class="co">## p1 =~ 1*x1</span></span>
<span><span class="co">## q1 =~ 1*y1</span></span>
<span><span class="co">## p2 =~ 1*x2</span></span>
<span><span class="co">## q2 =~ 1*y2</span></span>
<span><span class="co">## p3 =~ 1*x3</span></span>
<span><span class="co">## q3 =~ 1*y3</span></span>
<span><span class="co">## p4 =~ 1*x4</span></span>
<span><span class="co">## q4 =~ 1*y4</span></span>
<span><span class="co">##  p4 ~ 0.9 * p3 + 0.1 * q3</span></span>
<span><span class="co">##  q4 ~ 0.9 * q3 + 0.1 * p3</span></span>
<span><span class="co">##  p3 ~ 0.9 * p2 + 0.1 * q2</span></span>
<span><span class="co">##  q3 ~ 0.9 * q2 + 0.1 * p2</span></span>
<span><span class="co">##  p2 ~ 0.9 * p1 + 0.1 * q1</span></span>
<span><span class="co">##  q2 ~ 0.9 * q1 + 0.1 * p1</span></span>
<span><span class="co">##  p1 ~~ 1 * p1</span></span>
<span><span class="co">##  q1 ~~ 1 * q1</span></span>
<span><span class="co">##  p1 ~~ 0.5 * q1</span></span>
<span><span class="co">##  p2 ~~ 1 * p2</span></span>
<span><span class="co">##  q2 ~~ 1 * q2</span></span>
<span><span class="co">##  p2 ~~ 0.5 * q2</span></span>
<span><span class="co">##  p3 ~~ 1 * p3</span></span>
<span><span class="co">##  q3 ~~ 1 * q3</span></span>
<span><span class="co">##  p3 ~~ 0.5 * q3</span></span>
<span><span class="co">##  p4 ~~ 1 * p4</span></span>
<span><span class="co">##  q4 ~~ 1 * q4</span></span>
<span><span class="co">##  p4 ~~ 0.5 * q4</span></span>
<span><span class="co">##  p1 ~ 0  * U</span></span>
<span><span class="co">##  q1 ~ 0 * U</span></span>
<span><span class="co">##  p2 ~ 0  * U</span></span>
<span><span class="co">##  q2 ~ 0 * U</span></span>
<span><span class="co">##  p3 ~ 0  * U</span></span>
<span><span class="co">##  q3 ~ 0 * U</span></span>
<span><span class="co">##  p4 ~ 0  * U</span></span>
<span><span class="co">##  q4 ~ 0 * U</span></span>
<span><span class="co">##  U ~~ 0.5*U</span></span></code></pre>
<p>Fit a RI-CLPM</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="../reference/simulate_riclpm.html">simulate_riclpm</a></span><span class="op">(</span></span>
<span>         waves <span class="op">=</span> <span class="fl">4</span>,</span>
<span>         stability.p <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         stability.q <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         cross.p <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>         cross.q <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>         variance.p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         variance.q <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         cov.pq <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">data</span> </span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">omega</span>, <span class="op">-</span><span class="va">kappa</span><span class="op">)</span></span>
<span><span class="co"># Fit lavaan model</span></span>
<span><span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan</a></span><span class="op">(</span><span class="fu"><a href="../reference/model_syntax_clpm.html">model_syntax_clpm</a></span><span class="op">(</span>waves <span class="op">=</span> <span class="fl">4</span>, model_type <span class="op">=</span> <span class="st">"ri-clpm"</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">dat</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## lavaan 0.6-19 ended normally after 58 iterations</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Estimator                                         ML</span></span>
<span><span class="co">##   Optimization method                           NLMINB</span></span>
<span><span class="co">##   Number of model parameters                        27</span></span>
<span><span class="co">##   Number of equality constraints                     4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Number of observations                           500</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Test User Model:</span></span>
<span><span class="co">##                                                       </span></span>
<span><span class="co">##   Test statistic                                39.771</span></span>
<span><span class="co">##   Degrees of freedom                                13</span></span>
<span><span class="co">##   P-value (Chi-square)                           0.000</span></span></code></pre>
<p>I used the <span class="math inline">\(\texttt{monteCarlo}\)</span>
simulation function to vary within person stability – jointly – in x and
y, 1000 times. Here are the results fixing the cross-lag effect of x on
y to 0.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"~/Dropbox/github_repos/crossLag_p/crossLag/tmp/sim_crosslag.RData"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggridges/" class="external-link">ggridges</a></span><span class="op">)</span></span>
<span><span class="va">riDat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">within_person_stability_x</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xlag</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">within_person_stability_y</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">within_person_stability_y</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html" class="external-link">geom_density_ridges2</a></span><span class="op">(</span></span>
<span>    alpha <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    quantile_lines <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rel_min_height <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    quantiles <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    calc_ecdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    jittered_points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggridges/reference/position_points_jitter.html" class="external-link">position_points_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.05</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    point_shape <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    point_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    point_color <span class="op">=</span> <span class="st">"darkgrey"</span>,</span>
<span>    point_alpha <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>  <span class="co"># Remove the outline</span></span>
<span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">""</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co"># Draw a vertical line at 0 that is dashed, use abline</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">3</span>, label <span class="op">=</span> <span class="st">"True Value "</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Simulations varying the stability of Y across waves"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Style the plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Picking joint bandwidth of 0.00369</span></span></code></pre>
<p><img src="simulation_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>And here is the effect when <span class="math inline">\(y\)</span> is
unstable, but we vary <span class="math inline">\(x\)</span>.</p>
<p><img src="simulation_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>To examine them jointly, the following animation moves between
autocorrelation in the two variables.</p>
<p><img src="../docs/articles/simulation_files/figure-html/unnamed-chunk-9-1.gif"><!-- --></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
